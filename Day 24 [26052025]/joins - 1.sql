CREATE DATABASE JOINS1;
USE JOINS1;

CREATE TABLE EMPDETAILS(
	ID INT PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL,
    SALARY INT
);
INSERT INTO EMPDETAILS VALUES 
(1,"JOHN",40000),
(2,"ALEX",25000),
(3,"SIMON",43000);

CREATE TABLE MSTATUS(
	ID INT PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL,
    STATUSM VARCHAR(20)
);
INSERT INTO MSTATUS VALUES 
(1,"JOHN","MARRIED"),
(3,"SIMON","MARRIED"),
(4,"STELLA","UNMARRIED");
SELECT * FROM EMPDETAILS;
SELECT * FROM MSTATUS;

-- INNER JOIN
SELECT EMPDETAILS.NAME,SALARY,STATUSM
FROM EMPDETAILS
INNER JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID;

SELECT EMPDETAILS.NAME,SALARY,STATUSM
FROM EMPDETAILS
JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID; 


-- LEFT JOIN
SELECT EMPDETAILS.NAME,SALARY,STATUSM
FROM EMPDETAILS
LEFT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID;

SELECT MSTATUS.NAME,SALARY,STATUSM
FROM MSTATUS
LEFT JOIN EMPDETAILS
ON EMPDETAILS.ID = MSTATUS.ID; 


-- RIGHT JOIN
SELECT MSTATUS.NAME,SALARY,STATUSM
FROM EMPDETAILS 
RIGHT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID;

SELECT EMPDETAILS.NAME,SALARY,STATUSM
FROM MSTATUS 
RIGHT JOIN EMPDETAILS
ON EMPDETAILS.ID = MSTATUS.ID; 

-- SELF JOIN

CREATE TABLE COLORS(
	C1 VARCHAR(20),
    NAME VARCHAR(20),
    C2 VARCHAR(20)
);
INSERT INTO COLORS VALUES
("BLUE","JOHN","RED"),
("GREEN","ALEX","BLUE"),
("RED","SIMON","GREEN");
SELECT * FROM COLORS;

SELECT COLOR2.NAME,COLOR1.NAME 
FROM COLORS AS COLOR1,COLORS AS COLOR2
WHERE COLOR1.C1 = COLOR2.C2; 

SELECT COLOR2.NAME,COLOR1.NAME 
FROM COLORS COLOR1,COLORS COLOR2
WHERE COLOR1.C1 = COLOR2.C2; 

-- FULL JOIN

SELECT EMPDETAILS.NAME,SALARY,STATUSM
FROM EMPDETAILS
LEFT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID
UNION
SELECT MSTATUS.NAME,SALARY,STATUSM
FROM EMPDETAILS 
RIGHT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID; 

-- PROBLEMS
CREATE TABLE EMPLOYEES(
	EMP_ID INT,
    NAME VARCHAR(20),
    DEPARTMENT_ID INT,
    SALARY INT
);
INSERT INTO employees (emp_id, name, department_id, salary) VALUES
(101, 'Alice', 1, 50000),
(102, 'Bob', 2, 60000),
(103, 'Charlie', 2, 70000),
(104, 'David', 3, 45000),
(105, 'Eve', NULL, 40000),
(106, 'Frank', 4, 55000),
(107, 'Grace', 2, 62000);
SELECT * FROM EMPLOYEES;

CREATE TABLE DEPARTMENTS(
	DEPARTMENT_ID INT ,
    DEPARTMENT_NAME VARCHAR(20)
);
INSERT INTO departments (department_id, department_name) VALUES
(1, 'HR'),
(2, 'Engineering'),
(3, 'Marketing'),
(4, 'Finance');
SELECT * FROM DEPARTMENTS;

CREATE TABLE PROJECTS(
	PROJECT_ID INT,
    PROJECT_NAME VARCHAR(20),
    EMP_ID INT
);
INSERT INTO projects (project_id, project_name, emp_id) VALUES
(201, 'Website Redesign', 102),
(202, 'Mobile App', 103),
(203, 'Ad Campaign', 104),
(204, 'Data Migration', 106),
(205, 'Backend Optimization', 107),
(206, 'Product Launch', NULL); 

SELECT NAME,DEPARTMENT_NAME
FROM EMPLOYEES
INNER JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;

SELECT * FROM EMPLOYEES;
SELECT * FROM PROJECTS;

SELECT NAME,PROJECT_NAME
FROM EMPLOYEES
INNER JOIN PROJECTS
ON EMPLOYEES.EMP_ID = PROJECTS.EMP_ID;

SELECT NAME,DEPARTMENT_NAME
FROM EMPLOYEES
LEFT JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;
